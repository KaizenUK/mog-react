---
import { getSiteSettings } from "../lib/sanity/settings.ts";

type Props = {
  title?: string
  description?: string
  canonicalUrl?: string
  noIndex?: boolean
}

const {
  title = 'Midland Oil Group',
  description,
  canonicalUrl,
  noIndex = false,
} = Astro.props

const settings = await getSiteSettings()

// Default fallback keeps IA stable even if the Site Settings doc
// hasn't been created yet, or primaryNav is empty.
const defaultPrimaryNav = [
  { label: "Sectors", href: "/sectors" },
  { label: "Products", href: "/products" },
  { label: "Services", href: "/services" },
  { label: "News", href: "/news" },
  { label: "About", href: "/company/about-us" },
  { label: "Contact", href: "/contact-us" },
]

const primaryNav =
  Array.isArray(settings?.primaryNav) && settings.primaryNav.length > 0
    ? settings.primaryNav
    : defaultPrimaryNav
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>

    {description && <meta name="description" content={description} />}
    {canonicalUrl && <link rel="canonical" href={canonicalUrl} />}
    {noIndex && <meta name="robots" content="noindex, nofollow" />}
  </head>

  <body>
    <header style="border-bottom: 1px solid #eee;">
      <div style="max-width: 1100px; margin: 0 auto; padding: 16px 24px; display:flex; gap:16px; align-items:center; justify-content:space-between;">
        <a href="/" style="font-weight:700; text-decoration:none; color:inherit;">
          Midland Oil Group
        </a>

        <div style="display:flex; align-items:center; gap:14px; flex-wrap:wrap;">
          <nav style="display:flex; gap:14px; flex-wrap:wrap;">
            {primaryNav.map((item) => (
              <a href={item.href}>{item.label}</a>
            ))}
          </nav>
          
          <a
            href="/find-the-right-oil"
            style="
              display:inline-block;
              padding: 8px 12px;
              border: 1px solid #111;
              border-radius: 8px;
              text-decoration: none;
              font-weight: 600;
              white-space: nowrap;
            "
            aria-label="Find the right oil"
          >
            Find the right oil
          </a>
        </div>
      </div>
    </header>

    <main style="max-width: 1100px; margin: 0 auto; padding: 24px;">
      <slot />
    </main>

    <footer style="border-top: 1px solid #eee;">
      <div style="max-width: 1100px; margin: 0 auto; padding: 16px 24px; font-size: 14px; opacity: .8;">
        <div>Â© {new Date().getFullYear()} Midland Oil Group</div>
      </div>
    </footer>
  </body>
</html>
