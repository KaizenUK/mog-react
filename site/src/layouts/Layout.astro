---
import { getNavigationData } from "../lib/sanity/navigation.ts";
import Navigation from "../components/Navigation.astro";
import "../styles/global.css";

type Props = {
  title?: string
  description?: string
  canonicalUrl?: string
  noIndex?: boolean
}

const {
  title = 'Midland Oil Group',
  description,
  canonicalUrl,
  noIndex = false,
} = Astro.props

const navData = await getNavigationData();

// Draft mode is enabled when the cookie is present (set by /api/draft-mode)
const isDraftMode = Astro.cookies.get('sanity-draft-mode')?.value === '1'
const enableVisualEditing = import.meta.env.DEV || isDraftMode
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>

    {description && <meta name="description" content={description} />}
    {canonicalUrl && <link rel="canonical" href={canonicalUrl} />}
    {noIndex && <meta name="robots" content="noindex, nofollow" />}

    <!-- Fonts: Oswald + Lato -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Oswald:wght@400;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <Navigation sectors={navData.sectors} products={navData.products} />

    <!-- Full-width slot â€” hero and other edge-to-edge sections go here -->
    <slot name="above-main" />

    <main style="max-width: 1100px; margin: 0 auto; padding: 24px;">
      <slot />
    </main>

    <footer style="border-top: 1px solid #eee;">
      <div style="max-width: 1100px; margin: 0 auto; padding: 16px 24px; font-size: 14px; opacity: .8;">
        <div>&copy; {new Date().getFullYear()} Midland Oil Group</div>
      </div>
    </footer>

    <!-- Sanity visual editing overlays: active in dev and when draft-mode cookie is set -->
    {enableVisualEditing && (
      <script>
        import { enableVisualEditing } from '@sanity/visual-editing'
        enableVisualEditing()
      </script>
    )}
  </body>
</html>
