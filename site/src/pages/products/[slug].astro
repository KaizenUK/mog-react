---
import { getAllProductSlugs } from "../../lib/sanity/products";

export async function getStaticPaths() {
  const slugs = await getAllProductSlugs();
  return slugs.map((slug) => ({ params: { slug } }));
}

const { slug } = Astro.params;

if (!slug || slug === "undefined") {
  return Astro.redirect("/products", 301);
}

return Astro.redirect(`/product/${slug}`, 301);
---
